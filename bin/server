#!/usr/bin/env node

var http = require('http'),
    port = 8080,
    numreq = 0,
    url = 'http://localhost:' + port + '/';
/* We can access nodejitsu enviroment variables from process.env */
/* Note: the SUBDOMAIN variable will always be defined for a nodejitsu app */
if(process.env.SUBDOMAIN){
  url = 'http://' + process.env.SUBDOMAIN + '.jit.su/';
}
	

function start() {
	function onRequest (req, res) {
	  numreq +=1
	  res.writeHead(200, {'Content-Type': 'text/plain'});
	  res.write('hello, I know nodejitsu! OLOLO');
	  res.write('request recieved '+ numreq + ' times');
	  res.end();
	}
	http.createServer(onRequest).listen(port);
	console.log('The http server has started at: ' + url);
}

exports.start = start;